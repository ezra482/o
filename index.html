<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bible Reader（双语圣经）</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", "Noto Sans SC", sans-serif;
      background: #fdfcf9;
      color: #333;
      overflow: hidden;
    }
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(135deg, #fff8e7, #f9f5ff);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      animation: fadeOut 4s ease forwards;
      animation-delay: 3s;
      z-index: 10;
    }
    #splash h1 {
      font-size: 2.2em;
      color: #6b4f1d;
      margin-bottom: 10px;
      text-align: center;
    }
    #splash p {
      color: #8b6f3e;
      font-size: 1.1em;
      text-align: center;
      font-style: italic;
    }
    @keyframes fadeOut {
      to {
        opacity: 0;
        visibility: hidden;
      }
    }
    #main {
      display: none;
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
    }
  </style>
</head>
<body>
  <div id="splash">
    <h1>欢迎阅读圣经</h1>
    <p>“愿主的话成为你脚前的灯、路上的光。”（诗篇 119:105）</p>
  </div>

  <div id="main">
    <h2>Bible Reader（双语圣经）</h2>
    <p>加载中...</p>
  </div>

  <audio id="bgm" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_9bfe2c4470.mp3?filename=piano-soft-background-ambient-11058.mp3" loop></audio>

  <script>
    window.addEventListener("load", () => {
      const bgm = document.getElementById("bgm");
      // 尝试自动播放音乐
      bgm.volume = 0.4;
      bgm.play().catch(() => {
        console.log("浏览器阻止了自动播放，稍后可手动开启。");
      });

      setTimeout(() => {
        document.getElementById("splash").style.display = "none";
        document.getElementById("main").style.display = "block";
      }, 4000);
    });
  </script>
  <style>
    /* 工具栏样式 */
    #toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #fffbea;
      border-bottom: 1px solid #ddd;
      padding: 10px 15px;
      position: sticky;
      top: 0;
      z-index: 5;
    }
    #toolbar input {
      width: 60%;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    #toolbar button {
      background: #f2e4b8;
      border: none;
      padding: 6px 10px;
      border-radius: 8px;
      cursor: pointer;
    }
    #toolbar button:hover {
      background: #e4d6a8;
    }
    #bible-content {
      margin-top: 15px;
      line-height: 1.7;
    }
    .verse {
      margin: 8px 0;
    }
    .cn {
      color: #333;
    }
    .en {
      color: #666;
      font-size: 0.9em;
    }
    #notes {
      margin-top: 20px;
    }
    textarea {
      width: 100%;
      height: 100px;
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 8px;
      resize: vertical;
    }
  </style>

  <div id="toolbar">
    <input type="text" id="searchInput" placeholder="搜索经文或关键字..." />
    <button onclick="speakVerse()">朗读</button>
    <button onclick="toggleLang()">切换语言</button>
    <button onclick="saveNote()">保存笔记</button>
  </div>

  <div id="bible-content"></div>

  <div id="notes">
    <h3>我的笔记</h3>
    <textarea id="noteArea" placeholder="在此记录你的感悟..."></textarea>
  </div>
  <script>
    const bibleData = {
      "创世记 1": [
        { cn: "起初神创造天地。", en: "In the beginning God created the heaven and the earth." },
        { cn: "地是空虚混沌，渊面黑暗；神的灵运行在水面上。", en: "And the earth was without form, and void; and darkness was upon the face of the deep." },
        { cn: "神说：“要有光”，就有了光。", en: "And God said, Let there be light: and there was light." }
      ],
      "约翰福音 3": [
        { cn: "有一个法利赛人，名叫尼哥底母，是犹太人的官。", en: "There was a man of the Pharisees, named Nicodemus, a ruler of the Jews:" },
        { cn: "他夜里来见耶稣，说：“拉比，我们知道你是由神那里来作师傅的。”", en: "The same came to Jesus by night, and said unto him, Rabbi, we know that thou art a teacher come from God:" },
        { cn: "神爱世人，甚至将他的独生子赐给他们。", en: "For God so loved the world, that he gave his only begotten Son." }
      ]
    };

    let currentChapter = "创世记 1";
    let showEnglish = true;

    function renderBible(chapter) {
      const container = document.getElementById("bible-content");
      container.innerHTML = `<h3>${chapter}</h3>`;
      bibleData[chapter].forEach(v => {
        const html = `
          <div class="verse">
            <div class="cn">${v.cn}</div>
            ${showEnglish ? `<div class="en">${v.en}</div>` : ""}
          </div>`;
        container.innerHTML += html;
      });
      localStorage.setItem("lastChapter", chapter);
    }

    function searchBible() {
      const q = document.getElementById("searchInput").value.trim();
      if (!q) return;
      let results = [];
      for (const [chap, verses] of Object.entries(bibleData)) {
        verses.forEach(v => {
          if (v.cn.includes(q) || v.en.toLowerCase().includes(q.toLowerCase())) {
            results.push({ chap, v });
          }
        });
      }
      const container = document.getElementById("bible-content");
      container.innerHTML = `<h3>搜索结果：“${q}”</h3>`;
      results.forEach(r => {
        container.innerHTML += `
          <div class="verse">
            <b>${r.chap}</b><br>
            <div class="cn">${r.v.cn}</div>
            ${showEnglish ? `<div class="en">${r.v.en}</div>` : ""}
          </div>`;
      });
    }

    document.getElementById("searchInput").addEventListener("keypress", e => {
      if (e.key === "Enter") searchBible();
    });

    function toggleLang() {
      showEnglish = !showEnglish;
      renderBible(currentChapter);
    }
    function speakVerse() {
      const verses = document.querySelectorAll(".verse");
      const msg = new SpeechSynthesisUtterance();
      msg.lang = showEnglish ? "en-US" : "zh-CN";
      msg.text = Array.from(verses)
        .map(v => showEnglish ? v.querySelector(".en")?.textContent : v.querySelector(".cn")?.textContent)
        .join(" ");
      window.speechSynthesis.speak(msg);
    }

    function saveNote() {
      const note = document.getElementById("noteArea").value;
      localStorage.setItem("bibleNote", note);
      alert("✅ 笔记已自动保存");
    }

    window.addEventListener("load", () => {
      const last = localStorage.getItem("lastChapter");
      if (last && bibleData[last]) currentChapter = last;
      renderBible(currentChapter);
      const savedNote = localStorage.getItem("bibleNote");
      if (savedNote) document.getElementById("noteArea").value = savedNote;
    });
  </script>
</body>
</html>
